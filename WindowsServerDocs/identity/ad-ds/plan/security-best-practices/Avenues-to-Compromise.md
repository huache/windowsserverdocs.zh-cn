---
ms.assetid: d7a4d2e1-217d-4ffc-93f0-817149bd9e7f
title: 危及系统安全的途径
author: iainfoulds
ms.author: iainfou
manager: daveba
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: 31d936647be758c3f9cf2cd6d922f00ec5554e98
ms.sourcegitcommit: 1dc35d221eff7f079d9209d92f14fb630f955bca
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/26/2020
ms.locfileid: "88938207"
---
# <a name="avenues-to-compromise"></a>危及系统安全的途径

>适用于：Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

*定律7：最安全的网络是一种管理良好的网络。* - [安全管理的10个永恒定律](/previous-versions/cc722488(v=technet.10))

在遇到灾难性危害事件的组织中，评估通常会发现组织对其 IT 基础结构的实际状态具有有限的可见性，这可能会与 "已记录" 状态明显不同。 这些差异会引入漏洞，这些漏洞会使环境遭受损害，这通常会降低发现风险，直到攻击者有效地 "拥有" 环境。

对这些组织的 AD DS 配置、公钥基础结构 (Pki) 、服务器、工作站、应用程序、访问控制列表 (Acl) 和其他技术的详细评估将显示配置错误，如果修正，可能会阻止初始入侵。

对 IT 文档、过程和过程的分析可识别由攻击者利用的漏洞所带来的漏洞，最终获得用于充分损害 Active Directory 林的权限。 完全泄露的林是指攻击者不仅泄露单独的系统、应用程序或用户帐户，而且还会升级其访问权限，以获取可修改或销毁林的所有方面的权限级别。 如果 Active Directory 安装已泄露，则攻击者可能会进行更改，使其在整个环境中保持存在，或更糟地销毁该目录以及它所管理的系统和帐户。

尽管下面的说明中的一系列常利用的漏洞不是针对 Active Directory 的攻击，但它们允许攻击者在可用于运行特权提升 (环境中建立据点，这种情况也被称为 "特权提升") 攻击，并最终针对 AD DS。

本文档的此部分重点介绍攻击者通常用于获取对基础结构的访问权限，并最终启动权限提升攻击的机制。 另请参阅以下部分：

-   [降低 Active Directory 攻击面](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md) Active Directory 安全配置的详细建议。

-   [监视 Active Directory 以获得损害迹象](../../../ad-ds/plan/security-best-practices/Monitoring-Active-Directory-for-Signs-of-Compromise.md) 帮助检测折衷的建议

-   [规划折衷](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Planning-for-Compromise.md) 高级方法，有助于针对基础结构和业务观点的基础结构进行攻击

> [!NOTE]
> 尽管本文档重点介绍作为 AD DS 域的一部分的 Active Directory 和 Windows 系统，但攻击者很少只关注 Active Directory 和 Windows。 在混合使用操作系统、目录、应用程序和数据存储库的环境中，通常会发现非 Windows 系统也已经泄露。 如果系统在 Windows 和非 Windows 环境之间提供 "桥" （例如，Windows 和 UNIX 或 Linux 客户端访问的文件服务器）、为多个操作系统提供身份验证服务的目录，或将数据同步到不同目录的 metadirectories，则更是如此。
>
> 由于集中访问和配置管理功能，它不仅提供给 Windows 系统，还提供给其他客户端，因此 AD DS 目标。 任何其他提供身份验证和配置管理服务的目录或应用程序都可以并将由确定的攻击者确定目标。 尽管本文档重点介绍可降低 Active Directory 安装泄露可能性的保护，但包括非 Windows 计算机、目录、应用程序或数据存储库的每个组织也应为针对这些系统的攻击做好准备。

## <a name="initial-breach-targets"></a>初始违规目标
没有人有意构建一个公开组织的 IT 基础结构。 第一次构造 Active Directory 林时，它通常是处于纯洁的，并且是最新的。 随着年经历和新的操作系统和应用程序的获取，它们将添加到林中。 由于 Active Directory 提供的可管理性优势被识别，更多内容会添加到目录，更多人员将其计算机或应用程序与 AD DS 集成，并且升级域以支持最新版本的 Windows 操作系统所提供的新功能。 但随着时间的推移，这种情况也是如此，即使在添加新基础结构的情况下，基础结构的其他部分也可能不会保留，它们最初是，系统和应用程序运行正常，因而不会引起注意，组织开始忘记它们尚未消除其传统基础结构。 根据我们在评估已遭破坏的基础结构、较早、更大、更复杂的环境中看到的内容，更有可能会有许多经常被利用的漏洞的实例。

不管攻击者的动机如何，大多数信息安全漏洞都是从一个或两个系统一次泄露的。 这些初始事件或网络入口点通常会利用可能已修复但未解决的漏洞。 [2012 数据违规调查报告 (DBIR) ](http://www.verizonbusiness.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf)，这是 Verizon 风险团队与许多国家安全机构和其他公司合作制定的年度研究，指出96% 的攻击是 "不太困难" 的，这就是 "通过简单或中间控制能够避免 97%"。 这些发现可能是以下经常被利用的漏洞的直接结果。

### <a name="gaps-in-antivirus-and-antimalware-deployments"></a>防病毒和反恶意软件部署中的缺口
*法律号码：过期的恶意软件扫描器只是根本不会有任何扫描仪。* - [安全性 (的十个永恒定律) 版本2.0 ](https://www.microsoft.com/en-us/msrc?rtc=1)

分析组织的防病毒和反恶意软件部署通常会显示一个环境，其中大多数工作站都配置了启用和最新的防病毒软件和反恶意软件。 通常情况下，工作站经常连接到公司环境或员工设备，其中的防病毒软件和反恶意软件可能难于部署、配置和更新。

然而，在许多受影响的环境中，服务器人口往往不太受保护。 如 [2012 数据违规调查](http://www.verizonbusiness.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf)中所报告，所有数据泄露的94% 涉及到服务器，这表示上一年的增长18%，并69了恶意软件的攻击百分比。 在服务器人口中，发现防病毒和反恶意软件安装的配置不正确，已过时、配置不正确，甚至已禁用。 在某些情况下，由管理人员禁用防病毒和反恶意软件，但在其他情况下，攻击者会在攻击服务器后通过其他漏洞禁用该软件。 当防病毒软件和反恶意软件禁用后，攻击者会在服务器上植物恶意软件，并专注于跨服务器总体传播安全漏洞。

重要的是，不仅要确保系统受到当前的全面恶意软件防护的保护，还需要监视系统以禁用或删除防病毒软件和反恶意软件，并在手动禁用时自动重新启动保护。 尽管没有防病毒软件和反恶意软件可保证所有感染的防护和检测，但正确配置并部署的防病毒和反恶意软件实现可以降低感染的可能性。

### <a name="incomplete-patching"></a>修补未完成
*定律3：如果你不能跟上安全修补程序，你的网络将不会太长。* - [安全管理的10个永恒定律](/previous-versions/cc722488(v=technet.10))

Microsoft 在每月的第二个星期二发布安全公告，不过，在每月的安全更新之间发布安全更新时 (这些更新也称为 "带外" 更新) 当该漏洞被确定为客户系统面临紧急风险时。 小型企业是否会将其 Windows 计算机配置为使用 Windows 更新来管理系统和应用程序的修补程序，或者大型组织使用管理软件（如 Microsoft 终结点 Configuration Manager）根据详细的分层计划部署修补程序，许多客户会以相对及时的方式修补其 Windows 基础结构。

但是，少数基础结构仅包括 Windows 计算机和 Microsoft 应用程序，在已损坏的环境中，通常会发现组织的修补程序管理策略包含缺口。 在这些环境中，Windows 系统的修补顺序不一致。 非 Windows 操作系统偶尔就会修补。 商业外 (COTS) 应用程序包含一些漏洞，这些漏洞适用于存在但尚未应用的修补程序。 网络设备通常配置为出厂默认凭据，在安装后不会更新任何年份。 尽管不能再对其进行修补，但其供应商不再支持的应用程序和操作系统经常会保持运行，尽管不能再对漏洞进行修补。 其中的每个未修补系统都代表了攻击者的另一个潜在入口点。

IT 消费化带来了额外的挑战，那就是使用员工拥有的设备来访问公司拥有的数据，组织可能几乎不能控制员工个人设备的修补和配置。 企业级硬件通常附带了企业就绪的配置选项和管理功能，并且在个别自定义和设备选择中的选择成本更低。 以员工为中心的硬件提供更广泛的制造商、供应商、硬件安全功能、软件安全功能、管理功能和配置选项，并且许多企业功能可能根本不存在。

#### <a name="patch-and-vulnerability-management-software"></a>修补程序和漏洞管理软件
如果为 Windows 系统和 Microsoft 应用程序提供有效的修补程序管理系统，则会解决修补程序的修补程序创建的部分攻击面。 但是，除非非 Windows 系统、非 Microsoft 应用程序、网络基础结构和员工设备还会不断更新修补程序和其他修补程序，否则基础结构将保持易受攻击。 在某些情况下，应用程序的供应商可能会提供自动更新功能;在其他情况下，可能需要设计一种定期检索和应用修补程序及其他修补程序的方法。

### <a name="outdated-applications-and-operating-systems"></a>过期的应用程序和操作系统
*"您不能期望使用六年以前的操作系统来防范六个月的旧攻击。"* -信息安全专业人员，拥有10年的安全企业安装经验

尽管 "获取最新的、保持最新的" 似乎是营销短语，但过时的操作系统和应用程序在许多组织的 IT 基础结构中产生了风险。 在2003中发布的操作系统仍可能受供应商的支持，并随用于解决漏洞的更新一起提供，但该操作系统可能不包含在较新版本的操作系统中添加的安全功能。 过时的系统甚至可能需要削弱某些 AD DS 安全配置来支持这些计算机的较少功能。

对于不再支持应用程序的供应商编写的使用旧身份验证协议的应用程序，通常不能重组支持更强的身份验证机制。 但是，组织的 Active Directory 域可能仍配置为存储 LAN Manager 哈希或可逆加密密码，以支持此类应用程序。 在引入新的操作系统之前编写的应用程序可能无法正常运行，也不会在当前操作系统上正常运行，要求组织维护较旧和较旧的系统，在某些情况下，完全不受支持的硬件和软件。

即使组织已将其域控制器更新到 Windows Server 2012、Windows Server 2008 R2 或 Windows Server 2008，通常也可以找到要运行 Windows Server 2003、Windows 2000 Server 或 Windows NT Server 4.0 (的重要部分，它们完全不受支持) 。 组织保留帐龄系统的时间越长，功能集之间的差异就越多，而且可能会导致生产系统不受支持。 另外，维护 Active Directory 林的时间越长，我们观察到的旧系统和应用程序在升级计划中丢失的时间就越多。 这可能意味着单个运行单个应用程序的计算机可能会引入域或林范围的漏洞，因为 Active Directory 配置为支持其旧协议和身份验证机制。

若要消除旧系统和应用程序，你应该首先关注对其进行标识和分类，然后确定是要升级还是替换应用程序或主机。 尽管很难找到不支持或升级路径的高专用应用程序的替代项，但你可以利用称为 "创造性销毁" 的概念，将旧版应用程序替换为提供所需功能的新应用程序。 在本文档后面的 "规划折衷" 部分更深入地介绍了如何[进行折衷](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Planning-for-Compromise.md)。

### <a name="misconfiguration"></a>配置错误
*定律4：在从不受保护的计算机上安装安全修补程序并不能以开头。* - [安全管理的10个永恒定律](/previous-versions/cc722488(v=technet.10))

即使在通常会保持最新和修补系统的环境中，我们通常还能识别操作系统、计算机上运行的应用程序和 Active Directory 的间隔或配置错误。 某些配置错误只公开本地计算机以进行破坏，但在计算机被 "拥有" 后，攻击者通常会专注于进一步传播其他系统中的漏洞，并最终 Active Directory。 下面是一些常见领域，其中标识了引入风险的配置。

#### <a name="in-active-directory"></a>在 Active Directory
攻击者最常使用的 Active Directory 中的帐户是那些是最高特权组的成员的帐户，如域管理员的成员 (DA) 、Enterprise Admins (EA) 或 (中的内置管理员) BA Active Directory 组。 应将这些组的成员身份降为尽可能少的帐户数，以便限制这些组的攻击面。 甚至可以消除这些特权组中的 "永久" 成员身份;也就是说，你可以实施一些设置，仅当需要其域和全林性的权限时，才能暂时填充这些组。 使用高特权帐户时，它们只能用于指定的安全系统，例如域控制器或安全管理主机。 为了 [降低 Active Directory 攻击面](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md)，提供了有助于实现所有这些配置的详细信息。

在 Active Directory 中评估最高特权组的成员身份时，我们通常会发现所有这三个特权组中的成员身份过多。 在某些情况下，组织在 DA 组中有几十个甚至上百个帐户。 在其他情况下，组织会直接将帐户放到内置的管理员组中，同时认为该组比 DAs 组 "权限更小"。 不是。 尽管 EA 权限很少且暂时需要，但我们经常在目录林根级域中找到 EA 组的一部分永久成员。 即使这是一个有效的冗余配置，在所有三个组中查找 IT 用户的日常管理帐户也是很常见的。 如 [降低 Active Directory 攻击面](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md)中所述，某个帐户是否是其中一个组或所有这些组的永久成员，该帐户可用于进行破坏，甚至还会销毁它所管理的 AD DS 环境以及系统和帐户。 为了 [降低 Active Directory 攻击面](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md)，在 Active Directory 中提供安全配置和使用特权帐户的建议。

#### <a name="on-domain-controllers"></a>在域控制器上
评估域控制器时，发现它们的配置和管理与成员服务器不同。 域控制器有时会运行在成员服务器上安装的相同应用程序和实用程序，而不是因为它们是在域控制器上需要的，而是因为应用程序是标准生成的一部分。 这些应用程序可以在域控制器上提供最少的功能，但通过要求使用打开端口、创建高特权服务帐户的配置设置，或者不应连接到域控制器的用户（除了身份验证和组策略应用程序以外的其他目的）授予对系统的访问权限，可大大增加其攻击面。 在某些情况下，攻击者使用了已在域控制器上安装的工具，不仅可以访问域控制器，而且不能修改或损坏 AD DS 数据库。

当我们提取域控制器上的 Internet Explorer 配置设置时，我们发现用户已使用在 Active Directory 中具有高权限级别的帐户登录，并且已使用这些帐户从域控制器访问 Internet 和 intranet。 在某些情况下，帐户已将域控制器上的 Internet Explorer 设置配置为允许下载 Internet 内容，并且已从 Internet 站点下载了免费软件实用程序，并将其安装在域控制器上。 默认情况下，为用户和管理员启用了 Internet Explorer 增强的安全配置，但我们经常发现管理员已禁用了。 当具有高特权的帐户访问 Internet 并将内容下载到任何计算机时，该计算机会面临严重的风险。 如果计算机是域控制器，则会将整个 AD DS 安装置于风险之中。

##### <a name="protecting-domain-controllers"></a>保护域控制器
域控制器应视为关键的基础结构组件，与文件、打印和应用程序服务器相比，安全的得到和配置更为严格。 域控制器不应运行域控制器正常运行所不需要的任何软件，也不能防止域控制器遭受攻击。 不应允许域控制器访问 Internet，并且应通过组策略的对象 (Gpo) 来配置和强制安全设置。 安全安装、配置和管理域控制器的详细建议在 [保护域控制器免遭攻击](../../../ad-ds/plan/security-best-practices/Securing-Domain-Controllers-Against-Attack.md)中提供。

#### <a name="within-the-operating-system"></a>在操作系统中
*定律2：如果攻击者不能更改计算机上的操作系统，则不是您的计算机。* - [安全性 (的十个永恒定律) 版本2.0 ](https://www.microsoft.com/en-us/msrc?rtc=1)

尽管某些组织为不同类型的服务器创建基准配置，并允许在安装操作系统后对其进行有限的自定义，但对受攻击环境进行分析常常会发现大量以 ad hoc 方式部署的服务器，并且可以手动、独立地进行配置。 执行同一功能的两个服务器之间的配置可能完全不同，这两个服务器的配置不安全。 相反，服务器配置基线可能会不断地强制执行，但也可以一致地进行配置;也就是说，服务器的配置方式是在给定类型的所有服务器上创建相同的漏洞。 错误配置包括禁用安全功能、向帐户授予过多的权利和权限 () 、在系统上使用相同的本地凭据，以及允许安装未经授权的应用程序和实用程序创建自己的漏洞。

##### <a name="disabling-security-features"></a>禁用安全功能
组织有时会禁用具有高级安全性的 Windows 防火墙 (WFAS) ，因为 WFAS 难于配置或需要大量工作。 但是，从 Windows Server 2008 开始，如果服务器上安装了任何角色或功能，则默认情况下将使用该角色或功能所需的最少特权来配置该角色或功能，并且会自动将 Windows 防火墙配置为支持该角色或功能。 通过禁用 (，而不是在其位置) 使用其他基于主机的防火墙，组织将增加整个 Windows 环境的受攻击面。 外围防火墙提供某些防护来防范直接以 Internet 为目标的攻击，但不能防范利用其他攻击媒介（如 [驱动器下载](https://www.microsoft.com/security/sir/glossary/drive-by-download-sites.aspx) 攻击）的攻击，也不提供源自 intranet 上其他受入侵系统的攻击。

用户帐户控制 (UAC) 设置有时在服务器上处于禁用状态，因为管理人员发现干扰性的提示。 尽管 [Microsoft 支持部门文章 2526083](https://support.microsoft.com/kb/2526083) 介绍了可能在 Windows Server 上禁用 uac 的情况，除非你运行的是在设计) 禁用 uac 的服务器核心安装 (，否则，你不应在服务器上禁用 uac，而无需仔细考虑和研究。

在其他情况下，服务器设置配置为不太安全的值，因为组织将过时的服务器配置设置应用于新的操作系统，例如将 Windows Server 2003 基准应用到运行 Windows Server 2012、Windows Server 2008 R2 或 Windows Server 2008 的计算机，而无需更改基线来反映操作系统中的更改。 部署新的操作系统时，请查看安全更改和配置设置，以确保所实现的设置适用且适用于新的操作系统，而不是将旧的服务器基准应用到新的操作系统。

##### <a name="granting-excessive-privilege"></a>授予过多权限
在几乎每个已评估的环境中，对 Windows 系统上的本地和基于域的帐户授予过多的特权。 用户在其工作站上被授予了本地管理员权限，成员服务器运行配置了权限超过其所需功能的服务，而服务器总体中的本地管理员组包含数十甚至数百个本地和域帐户。 计算机上只有一个特权帐户的泄露，使得攻击者能够破坏登录到计算机的每个用户和服务的帐户，并获取并利用凭据将该安全传播传播到其他系统。

虽然传递哈希 (PTH) 和其他凭据盗窃攻击现在无处不在，但这是因为，当攻击者获得对计算机的管理员或系统级别的访问权限时，可以轻松地轻松提取其他特权帐户的凭据。 即使没有允许从登录会话中获取凭据的工具，具有对计算机的特权访问权限的攻击者也可以轻松地安装击键记录器来捕获击键、屏幕截图和剪贴板内容。 如果攻击者具有对计算机的特权访问权限，则可以禁用反恶意软件，安装 rootkit，修改受保护的文件，或者在计算机上安装恶意软件，使攻击自动化或将服务器转为 [驱动器](https://www.microsoft.com/security/sir/glossary/drive-by-download-sites.aspx) 。

用于在一台计算机之外扩展违规行为的策略各不相同，但传播泄露的关键是获取对其他系统的高特权访问。 通过减少对任何系统具有特权访问权限的帐户数，你可以减少攻击面，而不只是该计算机的攻击面，但攻击者可能会从计算机中收集宝贵的凭据。

##### <a name="standardizing-local-administrator-credentials"></a>标准化本地管理员凭据
安全专家有很多辩论，因为在 Windows 计算机上重命名本地管理员帐户是否有价值。 本地管理员帐户的实际重要性是在多台计算机上配置这些帐户的用户名和密码是否相同。

如果本地管理员帐户在服务器上命名为相同的值，并且分配给该帐户的密码也被配置为相同的值，则攻击者可以在已获得管理员或系统级访问权限的一台计算机上提取该帐户的凭据。 攻击者最初不必泄露管理员帐户;它们只需要对作为本地管理员组成员的用户或配置为以本地系统或管理员权限运行的服务帐户的帐户进行破坏。 然后，攻击者可以提取管理员帐户的凭据，并将网络登录中的这些凭据重播到网络上的其他计算机。

只要另一台计算机的本地帐户的用户名和密码 (或密码哈希) 为所提供的帐户凭据，登录尝试便会成功，并且攻击者会获得对目标计算机的特权访问权限。 在当前版本的 Windows 中，默认情况下 [禁用](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753450(v=ws.11))内置 Administrator 帐户，但在旧版操作系统中，默认情况下会启用该帐户。

> [!NOTE]
> 某些组织特意配置了本地管理员帐户，以便在系统锁定所有其他特权帐户时，能够提供 "故障安全"。 但是，即使本地管理员帐户处于禁用状态，并且没有其他可用的帐户可以启用该帐户或使用管理员权限登录系统，系统仍可以启动到安全模式，并且可以重新启用内置本地管理员帐户，如 [Microsoft 支持部门文章 814777](https://support.microsoft.com/kb/814777)中所述。 此外，如果系统仍成功应用 Gpo，则可以将 GPO 修改为临时 () 重新启用管理员帐户，或者将受限制的组配置为将基于域的帐户添加到本地管理员组。 可以执行修复，并再次禁用管理员帐户。 为了有效地防止使用内置本地管理员帐户凭据的横向泄露，必须为本地管理员帐户配置唯一的用户名和密码。 若要通过 GPO 为本地管理员帐户部署唯一密码，请参阅 technet 上的 [通过 gpo 管理内置管理员帐户的密码](/previous-versions/mt227395(v=msdn.10)) 。  

##### <a name="permitting-installation-of-unauthorized-applications"></a>允许安装未授权的应用程序
*定律1：如果攻击者可能会劝诱您在您的计算机上运行他的程序，这并不是您的计算机。* - [安全性 (的十个永恒定律) 版本2.0 ](https://www.microsoft.com/en-us/msrc?rtc=1)

无论组织是否在服务器之间部署一致的基线设置，都不应允许安装不属于服务器定义的角色的应用程序。 通过允许安装的软件不是服务器的指定功能的一部分，服务器将被公开到无意或恶意安装的软件，这些软件会增加服务器的攻击面、引入应用程序漏洞或导致系统不稳定。

#### <a name="applications"></a>应用程序
如前文所述，应用程序通常会安装并配置为使用被授予的权限比应用程序实际需要的权限更多的帐户。 在某些情况下，应用程序的文档指定服务帐户必须是服务器本地 Administrators 组的成员，或者必须配置为在 LocalSystem 的上下文中运行。 这通常不是因为应用程序需要这些权限，但由于确定应用程序的服务帐户所需的权限和权限需要额外的时间和精力来实现投资。 如果应用程序不使用应用程序所需的最小特权进行安装，并且其配置功能能够正常运行，则系统会暴露给利用应用程序权限的攻击，而不会受到对操作系统本身的任何攻击。

### <a name="lack-of-secure-application-development-practices"></a>缺少安全的应用程序开发实践
存在支持业务工作负荷的基础结构。 在自定义应用程序中实现这些工作负荷的情况下，确保使用安全的最佳实践开发应用程序至关重要。 企业范围事件的根本原因分析通常会发现，最初的折衷受自定义应用程序（尤其是面向 Internet 的应用程序）的影响。 大多数这类折衷都是通过泄露众所周知的攻击（例如 SQL 注入 (注 sqli) 和跨站点脚本 (XSS) 攻击）来实现的。

SQL 注入是一种应用程序漏洞，该漏洞允许用户定义的输入修改传递到数据库以执行的 SQL 语句。 此输入可以通过应用程序中的字段、参数 (如查询字符串或 cookie) 或其他方法提供。 此注入的结果是，提供给数据库的 SQL 语句与开发人员在本质上是不同的。 例如，使用用于计算用户名/密码组合的常见查询：

`SELECT userID FROM users WHERE username = 'sUserName' AND password = 'sPassword'`

当数据库服务器收到此数据时，它指示服务器浏览 users 表，并返回任何用户名称和密码与用户所提供的用户名称和密码相匹配的 userID 记录，这些记录中的用户名和密码通过某种) 类型的登录形式 (。 在这种情况下，开发人员的意图是，如果用户可以提供正确的用户名和密码，则仅返回有效的记录。 如果其中任何一个不正确，则数据库服务器将找不到匹配的记录并返回一个空结果。

攻击者执行意外的操作（如提供自己的 SQL 来替换有效数据）时会出现此问题。 由于 SQL 被数据库服务器动态解释，因此，插入的代码将像开发人员已将其放入一起那样进行处理。 例如，如果攻击者输入用户 ID 和**xyz**的**管理员**或使用**1 = 1**作为密码，则数据库处理的结果语句将为：

`SELECT userID FROM users WHERE username = 'administrator' AND password = 'xyz' OR 1=1`

当数据库服务器处理此查询时，将在查询中返回表中的所有行，因为 1 = 1 的计算结果始终为 True，因此，如果知道或提供了正确的用户名和密码，则不重要。 大多数情况下，最终结果是用户将以用户数据库中的第一个用户身份登录;在大多数情况下，这将是管理用户。

除了简单登录外，格式错误的 SQL 语句（例如这种情况）可用于添加、删除或更改数据，甚至可以删除数据库中的 (删除) 整个表。 在大多数情况下，如果注 sqli 与过多的特权结合使用，则可以运行操作系统命令来创建新用户、下载攻击工具或执行攻击者选择的任何其他操作。

在跨站点脚本中，应用程序的输出中引入了该漏洞。 攻击从向应用程序提供格式不正确的数据的攻击开始，但在这种情况下，格式错误的数据采用脚本代码格式， (如 JavaScript) ，将由受害者的浏览器运行。 利用 XSS 漏洞，攻击者可以在启动浏览器的用户的上下文中运行目标应用程序的任何功能。 XSS 攻击通常由仿冒电子邮件发起，它鼓励用户单击连接到应用程序的链接，并运行攻击代码。

在联机银行和电子商务方案中经常会使用 XSS，在这种情况下，攻击者可以在被利用的用户的环境中进行购买或转让。 对于基于 web 的自定义标识管理应用程序，攻击者可能会允许攻击者创建自己的标识、修改权限和权限并导致系统泄露。

尽管跨站点脚本和 SQL 注入的全面讨论超出了本文档的讨论范围，但 " [开放式 Web 应用程序安全项目 (OWASP") ](https://www.owasp.org/index.php/Main_Page) 发布了一个前10个列表，其中详细讨论了漏洞和对策。

无论对基础结构安全的投资如何，如果在该基础结构中部署的设计和编写的应用程序都很糟糕，环境就容易受到攻击。 即使是安全可靠的基础结构通常也不能为这些应用程序攻击提供有效对策。 复合问题、设计不良的应用程序可能要求向服务帐户授予应用程序正常运行所需的权限。

Microsoft 安全开发生命周期 (SDL) 是一组结构化的过程控制，可用于在应用程序的整个生命周期内，通过应用程序的生命周期逐步改善安全性，直到它被取消。 从安全的角度来看，这种有效的安全控制措施并不只是关键，因此确保应用程序安全的成本和计划有效是至关重要的。 当应用程序在有效完成代码时评估其安全问题，需要组织仅在部署应用程序之前或之后做出有关应用程序安全的决策。 组织可以选择在生产环境中部署应用程序之前解决应用程序缺陷，从而导致成本和延迟，或者可以在生产环境中部署应用程序，从而使组织面临危害。

对于每个问题，某些组织将解决高于 $10000 的生产代码中的安全问题的全部成本，而在没有有效 SDL 的情况下开发的应用程序可平均每100000行增加10个高严重性问题。 在大型应用程序中，成本会迅速提升。 与此相反，许多公司在 SDL 的最终代码审查阶段为每100000行的代码提供了不到一次的问题基准，并在生产中的高风险应用程序中实现零问题。

通过在要求收集和设计应用程序的早期包括安全要求，实现 SDL 可以提高安全性，为高风险应用程序提供威胁建模;需要对开发人员进行有效培训和监视;和需要清晰、一致的代码标准和实践。 SDL 的最终效果是应用程序安全性方面的重大改进，同时降低开发、部署、维护和解除应用程序的部署成本。 尽管 SDL 设计和实施的详细讨论超出了本文档的讨论范围，但请参阅 [Microsoft 安全开发生命周期](https://www.microsoft.com/security/sdl/default.aspx) ，了解详细的指导和信息。


---
title: winnt32
description: 用于在 Windows Server 2003 中执行或升级到产品的 winnt32.exe 的参考文章。
ms.topic: reference
ms.assetid: 5a0a6fb3-ba4e-4ace-8984-7f6d3875560e
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 5c74f0645ccbe4745b155eb8b687d4c8ea5ff159
ms.sourcegitcommit: 96d46c702e7a9c3a321bbbb5284f73911c7baa3c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/27/2020
ms.locfileid: "89022691"
---
# <a name="winnt32"></a>winnt32

> 适用于： Windows Server (半年通道) ，Windows Server 2019，Windows Server 2016，Windows Server 2012 R2，Windows Server 2012

执行或升级到 Windows Server 2003 中的产品。 可以在运行 Windows 95、Windows 98、Windows Millennium edition、Windows NT、Windows 2000、Windows XP 或 Windows Server 2003 中的产品的计算机上的命令提示符下运行 **winnt32.exe** 。 如果在运行 Windows NT 4.0 版的计算机上运行 **winnt32.exe** ，则必须先应用 Service Pack 5 或更高版本。
## <a name="syntax"></a>语法
```
winnt32 [/checkupgradeonly] [/cmd: <CommandLine>] [/cmdcons] [/copydir:{i386|ia64}\<FolderName>] [/copysource: <FolderName>] [/debug[<Level>]:[ <FileName>]] [/dudisable] [/duprepare: <pathName>] [/dushare: <pathName>] [/emsport:{com1|com2|usebiossettings|off}] [/emsbaudrate: <BaudRate>] [/m: <FolderName>]  [/makelocalsource] [/noreboot] [/s: <Sourcepath>] [/syspart: <DriveLetter>] [/tempdrive: <DriveLetter>] [/udf: <ID>[,<UDB_File>]] [/unattend[<Num>]:[ <AnswerFile>]]
```
#### <a name="parameters"></a>参数

|     参数     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           说明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|-------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| /checkupgradeonly |                                                                                                                                                                                                                                                                                                                                                                                                                      检查您的计算机与 Windows Server 2003 中的产品的升级兼容性。<p>如果将此选项与 **/unattend**一起使用，则无需用户输入。  否则，结果将显示在屏幕上，你可以将它们保存在指定的文件名下。 默认文件名 **upgrade.txt** 在 systemroot 文件夹中。                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       /cmd        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                               指示安装程序在安装程序的最后阶段之前执行特定命令。 这会在计算机重新启动之后以及安装程序收集必要的配置信息之后、安装程序完成之前发生。                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|  \<CommandLine>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          指定要在安装程序的最后阶段执行的命令行。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|     /cmdcons      |                                                                                                                                                                                                                                                                                                                                                                                                                         在基于 x86 的计算机上，安装恢复控制台作为启动选项。  恢复控制台是一个命令行界面，你可以在其中执行诸如启动和停止服务以及访问本地驱动器 (的任务，包括使用 NTFS) 格式化的驱动器。 安装完成后，只能使用 **/cmdcons** 选项。                                                                                                                                                                                                                                                                                                                                                                                                                          |
|     /copydir      |                                                                                                                                                                                                                                                                        在安装操作系统文件的文件夹中创建另一个文件夹。  例如，对于基于 x86 和 x64 的计算机，可以在安装的 i386 源文件夹内创建一个名为 *Private_drivers* 的文件夹，并将驱动程序文件放在该文件夹中。 键入 **/copydir： i386 \\ **<em>Private_drivers</em>要让安装程序将该文件夹复制到新安装的计算机上，使新的**文件夹位置设置**为 \\ *Private_drivers*。<p>-   **i386** 指定 i386<br />-   **ia64** 指定 ia64<p>你可以使用 **/copydir** 来创建所需数量的其他文件夹。                                                                                                                                                                                                                                                                        |
|   \<FolderName>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           指定为保存站点所做的修改而创建的文件夹。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|    /copysource    |                                                                                                                                                                                                                                                                                                                                                                                                                                             在安装操作系统文件的文件夹中创建一个临时的附加文件夹。 你可以使用 **/copysource** 来创建所需数量的其他文件夹。<p>不同于 **/copydir** 创建的文件夹，在安装完成后将删除 **/copysource** 文件夹。                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|      /debug       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          在指定级别创建调试日志，例如， **/debug4： debug。**  默认日志文件为 **C：\systemroot\winnt32.log**和                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|     \<level>      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                         级别值和说明<p>-0：严重错误<br />-1：个错误<br />-2：默认级别。 警告<br />-3：信息<br />-4：用于调试的详细信息<p>每个级别都包括它下面的级别。                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|    /dudisable     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              阻止动态更新运行。 如果没有动态更新，安装程序将仅在原始安装文件中运行。 即使使用应答文件并在该文件中指定动态更新选项，此选项也会禁用动态更新。                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|    /duprepare     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                              在安装共享上执行准备，使其可用于从 Windows 更新网站下载的动态更新文件。 然后，可以使用此共享为多个客户端安装 Windows XP。                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|    \<pathName>    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    指定完整路径名称。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|     /dushare      |                                                                                                                                                                                                                                                                                                                                                                                                                       指定以前下载了动态更新文件的共享， (更新文件以与 Windows 更新网站上的安装程序) 一起使用，并且之前运行 **/duprepare：** _< 路径名>_。 当在客户端上运行时，指定客户端安装将使用中指定的共享上的已更新文件 <pathName> 。                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     /emsport      | 在安装过程中以及安装服务器操作系统后启用或禁用紧急管理服务。 利用紧急管理服务，你可以在紧急情况下远程管理服务器，这种情况通常需要本地键盘、鼠标和显示器，例如网络不可用或服务器无法正常工作。 紧急管理服务具有特定的硬件要求，仅适用于 Windows Server 2003 中的产品。<p>-   **com1** 仅适用于基于 x86 的计算机 (不) 基于 Itanium 体系结构的计算机。<br />-   **com2**仅适用于基于 x86 的计算机 (不) 基于 Itanium 体系结构的计算机。<br />缺省值. 使用在 BIOS 串行端口控制台重定向 (SPCR) 表中指定的设置，或使用基于 Itanium 体系结构的系统中的 EFI 控制台设备路径中指定的设置。 如果指定 **usebiossettings** ，但没有 SPCR 表或适当的 EFI 控制台设备路径，则将不会启用紧急管理 services。<br />-   **off** 禁用紧急管理服务。 稍后可以通过修改启动设置来启用它。 |
|   /emsbaudrate    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                对于基于 x86 的计算机，为紧急管理服务指定波特率。  (选项不适用于基于 Itanium 体系结构的计算机。 ) 必须用于 **/emsport： com1** 或 **/emsport： com2** (否则，) 将忽略  **/emsbaudrate** 。                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|    \<BaudRate>    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            指定波特率为9600、19200、57600或115200。 默认值为9600。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|        /m         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    指定安装程序从备用位置复制替换文件。  指示安装程序首先查找备用位置，如果文件存在，则使用这些文件而不是默认位置中的文件。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| /makelocalsource  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    指示安装程序将所有安装源文件复制到本地硬盘。  当 cd 在安装后不能使用时，请使用 **/makelocalsource** 从 cd 安装来提供安装文件。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|     /noreboot     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                指示安装程序在安装程序的文件复制阶段完成之后不重新启动计算机，以便您可以运行另一个命令。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|        /s         |                                                                                                                                                                                                                                                                                                                                                                                                                                         指定用于安装的文件的源位置。 若要同时从多个服务器复制文件，请多次键入 **/s：** \<Sourcepath> option，最多 (8 个) 。 如果多次键入此选项，则指定的第一个服务器必须可用，否则安装程序将失败。                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|   \<Sourcepath>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                指定完整的源路径名。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|     /syspart      |                                                                                                                                                                                                                                      在基于 x86 的计算机上，指定你可以将安装程序启动文件复制到硬盘上，将磁盘标记为活动，然后将磁盘安装到另一台计算机。 当你启动该计算机时，它会自动从安装的下一个阶段开始。<p>必须始终将 **/tempdrive** 参数与 **/syspart** 参数一起使用。<p>可以在运行 Windows NT 4.0、Windows 2000、Windows XP 或 Windows Server 2003 中的产品的基于 x86 的计算机上，使用 **/syspart**选项启动**winnt32.exe** 。 如果计算机运行的是 Windows NT 版本4.0，则需要 Service Pack 5 或更高版本。 计算机无法运行 Windows 95、Windows 98 或 Windows Millennium edition。                                                                                                                                                                                                                                       |
|  \<DriveLetter>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   指定驱动器号。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|    /tempdrive     |                                                                                                                                                                                                                                                                                                                                                                                                         指示安装程序将临时文件放在指定的分区上。<p>对于全新安装，还会在指定的分区上安装服务器操作系统。<p>对于升级， **/tempdrive** 选项仅影响临时文件的位置;操作系统将在从中运行 **winnt32.exe**的分区中进行升级。                                                                                                                                                                                                                                                                                                                                                                                                         |
|       /udf        |                                                                                                                                                                                                                                                                                                                                指示 \<ID> 安装程序使用 () 的标识符，该标识符用于指定唯一性数据库 (UDB) 文件如何修改应答文件 (查看 **/unattend** 选项) 。  UDB 将覆盖答案文件中的值，并且标识符确定使用 UDB 文件中的哪些值。 例如， **/udf： RAS_user，Our_company** 会替代在 Our_company 的 udb 文件中为 RAS_user 标识符指定的设置。 如果 \<UDB_file> 指定 "否"，则安装程序会提示用户插入包含 **$Unique $ udb** 文件的磁盘。                                                                                                                                                                                                                                                                                                                                |
|       \<ID>       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              指示一个标识符，该标识符用于指定唯一性数据库 (UDB) 文件修改应答文件的方式。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|    \<UDB_file>    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           指定 (UDB) 文件的唯一数据库。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|     /unattend     |                                                                                                                                                                                                                                                                                                                                                                                                                                                            在基于 x86 的计算机上，在无人参与安装模式下，将以前版本的 Windows NT 4.0 Server (升级为 Service Pack 5 或更高版本) 或 Windows 2000。 所有用户设置都是从以前的安装中获取的，因此在安装过程中不需要用户干预。                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|      \<num>       |                                                                                                                                                                                                                                                                                                                                                                                                        指定安装程序完成复制文件的时间与重新启动计算机之间的秒数。 可以 \<Num> 在运行 windows 98、Windows Millennium edition、WINDOWS NT、windows 2000、WINDOWS XP 或 Windows Server 2003 中产品的任何计算机上使用。 如果计算机运行的是 Windows NT 版本4.0，则需要 Service Pack 5 或更高版本。                                                                                                                                                                                                                                                                                                                                                                                                        |
|   \<AnswerFile>   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         为安装提供自定义规范                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|        /?         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              在命令提示符下显示帮助。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |

## <a name="remarks"></a>注解
如果要在客户端计算机上部署 Windows XP，则可以使用 Windows XP 附带的 winnt32.exe 版本。 部署 Windows XP 的另一种方法是使用 winnt32.msi，该方法可通过 Windows Installer 的一组智能技术来运行。 有关客户端部署的详细信息，请参阅 Windows Server 2003 部署工具包，这在 [使用 Windows 部署和资源工具包](/previous-versions/windows/it-pro/windows-server-2003/cc779317(v=ws.10))中进行了介绍。

在基于 Itanium 的计算机上，可以从 (EFI) 或 Windows server 2003 Enterprise、Windows Server 2003 R2 Enterprise、Windows Server 2003 R2 Datacenter 或 Windows Server 2003 Datacenter 的可扩展固件接口运行 **winnt32.exe** 。 另外，在基于 Itanium 体系结构的计算机上， **/cmdcons** 和 **/syspart** 不可用，并且与升级相关的选项将不可用。
有关硬件兼容性的详细信息，请参阅 [硬件兼容性](/previous-versions/windows/it-pro/windows-server-2003/cc757927(v=ws.10))。
有关使用动态更新和安装多个客户端的详细信息，请参阅 Windows Server 2003 部署工具包，这在 [使用 Windows 部署和资源工具包](/previous-versions/windows/it-pro/windows-server-2003/cc779317(v=ws.10))中进行了介绍。
有关修改启动设置的信息，请参阅 windows Server 2003 的 Windows 部署和资源工具包。 有关详细信息，请参阅 [使用 Windows 部署和资源工具包](/previous-versions/windows/it-pro/windows-server-2003/cc779317(v=ws.10))。
使用 **/unattend** 命令行选项自动执行已阅读并接受 Windows Server 2003 的 Microsoft 许可协议的安装程序确认。 在使用此命令行选项代表组织之外的其他组织安装 Windows Server 2003 之前，必须确认最终用户 (个人或单个实体) 是否已收到、阅读并接受该产品的 Microsoft 许可协议条款。  Oem 不能在销售给最终用户的计算机上指定此密钥。

## <a name="additional-references"></a>其他参考
- [命令行语法项](command-line-syntax-key.md)

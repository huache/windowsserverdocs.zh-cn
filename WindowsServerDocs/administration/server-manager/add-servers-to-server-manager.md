---
title: Add Servers to Server Manager
description: 服务器管理器
ms.topic: article
ms.assetid: aab895f2-fe4d-4408-b66b-cdeadbd8969e
ms.author: lizross
author: eross-msft
manager: mtillman
ms.localizationpriority: medium
ms.date: 02/01/2018
ms.openlocfilehash: f8c3a2088533924f38b49454ab6f810c7cc9aa2e
ms.sourcegitcommit: db2d46842c68813d043738d6523f13d8454fc972
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/10/2020
ms.locfileid: "89628478"
---
# <a name="add-servers-to-server-manager"></a>Add Servers to Server Manager

>适用于：Windows Server（半年频道）、Windows Server 2016、Windows Server 2012 R2、Windows Server 2012

在 Windows Server 中可以通过使用单一服务器管理器控制台来管理多个远程服务器。 你希望使用服务器管理器管理的服务器可以运行 Windows Server 2016、Windows Server 2012 R2、Windows Server 2012、Windows Server 2008 R2 或 Windows Server 2008。 请注意：无法使用较旧版本的服务器管理器管理较新版本的 Windows Server。

本主题介绍如何向服务器管理器服务器池添加服务器。

> [!NOTE]
> 在我们的测试中，Windows Server 2012 以及更高版本的 Windows Server 中的服务器管理器可用于管理最多 100 台配置有典型工作负载的服务器。 可以使用单一服务器管理器控制台管理的服务器数量可能取决于从托管服务器请求的数据量，以及可用于运行服务器管理器的计算机的硬件和网络资源的量。 当你想要显示的数据量接近该计算机的资源容量时，服务器管理器的响应可能变慢，刷新可能延迟完成。 若要使用服务器管理器管理更多服务器，我们建议使用**配置事件数据**对话框中的设置，限制服务器管理器从你的托管服务器获取的事件数据。 “配置事件数据”可从“事件”**** 磁贴中的“任务”**** 菜单打开。 如果需要管理组织中企业级服务器的数量，我们建议在 [Microsoft System Center suite](https://go.microsoft.com/fwlink/p/?LinkId=239437)中评估产品。
>
> 服务器管理器只能从运行 Windows Server 2003 的服务器接收联机或脱机状态。 虽然你可以使用服务器管理器在运行 Windows Server 2008 R2 或 Windows Server 2008 的服务器上执行任务管理，但无法将角色和功能添加到运行 Windows Server 2008 R2、Windows Server 2008 或 Windows Server 2003 的服务器.
>
> 服务器管理器无法用于管理较新版本的 Windows Server 操作系统。 在 Windows Server 2012 R2、Windows Server 2012、Windows 8.1 或 Windows 8 上运行的服务器管理器无法用于管理运行 Windows Server 2016 的服务器。

本主题包含以下各节：

-   [添加要管理的服务器](#BKMK_add)

-   [使用“管理方式”命令提供凭据](#BKMK_creds)

## <a name="provide-credentials-with-the-manage-as-command"></a><a name=BKMK_creds></a>使用“管理方式”命令提供凭据
在将远程服务器添加到服务器管理器时，所添加的一些服务器可能需要不同的用户帐户凭据来进行访问或管理。 若为托管服务器指定的凭据与你用于登录运行服务器管理器的计算机的凭据不同，请在将服务器添加到服务器管理器后使用**管理方式**命令，此命令可通过右键单击角色或组主页上的**服务器**磁贴中的托管服务器条目访问。 单击“管理方式”**** 将打开“Windows 安全性”**** 对话框中，你可以在该对话框中采用以下某种格式提供在托管服务器上具有访问权限的用户名。

-   *用户名*

-   *用户名*@example.domain.com

-   *域* \\*用户名*

由**管理方式**命令打开的 **Windows 安全中心**对话框无法接受智能卡凭据；不支持通过服务器管理器提供智能卡凭据。 使用**管理方式**命令为托管服务器提供的凭据会被缓存，只要你正在使用当前运行服务器管理器的同一台计算机管理服务器，或不通过为同一台服务器指定空白或其他凭据来覆盖它们，这些凭据就会保留。 如果你将服务器管理器设置导出到其他计算机，或将域配置文件配置为漫游以允许服务器管理器设置在其他计算机上使用，则服务器池中服务器的**管理方式**凭据将不会存储在漫游配置文件中。 服务器管理器用户必须将凭据添加到想要管理的每台计算机上。

在按照本主题中的过程添加要管理的服务器之后，但在使用“管理方式”**** 命令指定可能需要用于管理所添加服务器的备用凭据之前，可能会针对服务器显示以下可管理性状态错误：

-   Kerberos 目标解析错误

-   Kerberos 身份验证错误

-   联机 - 访问被拒绝

> [!NOTE]
> 不支持 " **管理方式** " 命令的角色和功能包括远程桌面服务 (RDS) 和 IP 地址管理 (IPAM) Server。 如果你无法通过使用在运行服务器管理器的计算机上使用的相同凭据管理远程 RDS 或 IPAM 服务器，请尝试将你通常用来管理这些远程服务器的帐户添加到运行服务器管理器的计算机上的管理员组。 然后，使用你用来管理运行 rdS 或 IPAM 的远程服务器的帐户登录到正在运行服务器管理器的计算机。

## <a name="add-servers-to-manage"></a><a name=BKMK_add></a>添加要管理的服务器
你可以使用**添加服务器**对话框中三种方法的任何一种来将服务器添加到服务器管理器以进行管理。

-   **Active Directory 域服务** 添加服务器以管理 Active Directory 在本地计算机所在的域中查找。

-   **域名系统 (DNS) 条目** 按计算机名或 IP 地址搜索要管理的服务器。

-   **导入多个服务器** 指定要在包含按计算机名或 IP 地址列出的服务器的文件中导入的多个服务器。

#### <a name="to-add-servers-to-the-server-pool"></a>向服务器池中添加服务器

1.  如果服务器管理器已经打开，则继续执行下一步。 如果服务器管理器尚未打开，请执行以下任一操作打开它。

    -   在 Windows 桌面上，启动服务器管理器，方法是单击 Windows 任务栏中的“服务器管理器”  。

    -   在 Windows 的 " **开始** " 屏幕上，单击 "服务器管理器" 磁贴。

2.  在 " **管理** " 菜单上，单击 " **添加服务器**"。

3.  执行下列操作之一：

    -   在 " **active directory** " 选项卡上，选择当前域中的服务器。 按 **Ctrl** 并选择以选择多台服务器。 单击右箭头按钮以将选定服务器移到 " **选定** " 列表。

    -   在“DNS”**** 选项卡上，键入计算机名或 IP 地址的前几个字符，再按 **Enter** 或单击“搜索”****。 选择要添加的服务器，然后单击右箭头按钮。

    -   在 " **导入** " 选项卡上，浏览到包含要添加的计算机的 DNS 名称或 ip 地址的文本文件，每行一个名称或 ip 地址。

4.  添加完服务器时，单击“确定”。****

### <a name="add-and-manage-servers-in-workgroups"></a>在工作组中添加和管理服务器
尽管将位于工作组的服务器添加到服务器管理器可能会成功，但在添加后，**服务器**磁贴（包括工作组服务器的角色或组页面上）的**可管理性**列会显示尝试连接到或从远程工作组服务器收集数据时发生的**凭据无效**错误。

在以下情况下可能发生这些错误或类似的错误。

-   托管服务器与运行服务器管理器的计算机位于相同的工作组中。

-   托管服务器与运行服务器管理器的计算机位于不同的工作组中。

-   一台计算机位于工作组中，另一台计算机位于域中。

-   运行服务器管理器的计算机位于工作组中，而远程的托管服务器位于其他子网中。

-   两台计算机都位于域中，但两个域之间没有信任关系。

-   两台计算机都位于域中，但两个域之间只有单向信任关系。

-   已使用 IP 地址添加要管理的服务器。

##### <a name="to-add-remote-workgroup-servers-to-server-manager"></a>将远程工作组服务器添加到服务器管理器

1.  在运行服务器管理器的计算机上，将工作组服务器名称添加到 **TrustedHosts** 列表。 这是 NTLM 身份验证的要求。 若要将计算机名称添加到现有的受信任主机列表中，请向命令中添加 `Concatenate` 参数。 例如，若要将 `Server01` 计算机添加到现有受信任主机列表，请使用以下命令。

    ```
    Set-Item wsman:\localhost\Client\TrustedHosts Server01 -Concatenate -force
    ```

2.  确定要管理的工作组服务器是否与要在其上运行服务器管理器的计算机位于同一子网。

    如果两台计算机在同一子网中，或者如果工作组服务器的网络配置文件在 "**网络和共享中心**" 中设置为 "**专用**"，请继续执行下一步。

    如果它们不在同一子网中，或者如果工作组服务器的网络配置文件未设置为 "**专用**"，则在工作组服务器上，在 "windows 防火墙" 的 "**计算机**" 选项卡上将 "入站**windows 远程管理" (") ** " 设置 "更改为显式允许来自远程计算机**Properties**的连接。

3.  > [!IMPORTANT]
    > 在此步骤中运行 cmdlet 覆盖用户账户控制 (UAC) 措施（阻止提升的进程在工作组计算机上运行，除非内置管理员或者系统账户正在运行进程）。 cmdlet 允许管理员组成员管理工作组服务器，无需以内置管理员身份登录。 允许其他用户管理工作组服务器会降低其安全性，不过，这比向正在管理工作组服务器的多个人提供内置管理员账户凭据更安全。

    若要替代在工作组计算机上运行提升进程的 UAC 限制，请运行以下 cmdlet，以在工作组服务器上创建名为 **LocalAccountTokenFilterPolicy** 的注册表项。

    ```
    New-ItemProperty -Name LocalAccountTokenFilterPolicy -path HKLM:\SOFTWARE\Microsoft\Windows\Currentversion\Policies\System -propertytype DWord -value 1
    ```

4.  在运行服务器管理器的计算机上，打开**所有服务器**页。

5.  如果运行服务器管理器的计算机和目标工作组服务器位于同一工作组，请跳到最后一步。 如果两台计算机不位于同一工作组，请在“服务器”**** 图块中右键单击目标工作组服务器，再单击“管理方式”****。

6.  使用工作组服务器的内置管理员帐户登录到工作组服务器。

7.  确定服务器管理器能够连接到和从工作组服务器收集数据，方法是刷新**所有服务器**页面，再查看工作组服务器的可管理性状态。

##### <a name="to-add-remote-servers-when-server-manager-is-running-on-a-workgroup-computer"></a>当服务器管理器在工作组计算机上运行时添加远程服务器

1.  在运行服务器管理器的计算机上，将远程服务器添加到 Windows PowerShell 会话中本地计算机的 **TrustedHosts** 列表中。 若要将计算机名称添加到现有的受信任主机列表中，请向命令中添加 `Concatenate` 参数。 例如，若要将 `Server01` 计算机添加到现有受信任主机列表，请使用以下命令。

    ```
    Set-Item wsman:\localhost\Client\TrustedHosts Server01 -Concatenate -force
    ```

2.  确定要管理的服务器是否与要在其上运行服务器管理器的工作组计算机位于同一子网。

    如果两台计算机位于同一子网，或工作组服务器的网络配置文件在**网络和共享中心**中设置为**专用**，请继续执行下一步。

    如果它们不位于同一子网，或工作组计算机的网络配置文件不是设置为**专用**，则在运行服务器管理器的工作组计算机上，在 Windows 防火墙上将入站 **Windows 远程管理 (HTTP-In)** 设置更改为显式允许来自远程计算机的连接，方法是在设置**属性**对话框的**计算机**选项卡上添加计算机名称。

3.  在运行服务器管理器的计算机上，打开**所有服务器**页。

4.  确定服务器管理器能够连接到和从远程服务器收集数据，方法是刷新**所有服务器**页面，再查看远程服务器的可管理性状态。 如果“服务器”**** 图块仍显示远程服务器的可管理性错误，请继续执行下一步。

5.  注销要在其上运行服务器管理器的计算机，再使用内置管理员帐户重新登录。 重复上一步，以确定服务器管理器能够连接到并从远程服务器收集数据。

如果已按照本部分中的步骤操作，但在管理工作组计算机或从工作组计算机管理其他计算机时仍出现问题，请参阅 Microsoft 网站上的 [about_remote_Troubleshooting](/previous-versions/dd347642(v=technet.10)) 。

### <a name="add-and-manage-servers-in-clusters"></a>在群集中添加和管理服务器
可以使用服务器管理器来管理故障转移群集（也称为服务器群集或 MSCS）中的服务器。 故障转移群集中的服务器（无论群集节点是物理节点还是虚拟节点）在服务器管理器中有一些特有的行为和管理限制。

-   将群集中的一台服务器添加到服务器管理器时，群集中的物理服务器和虚拟服务器都会自动添加到服务器管理器。 同样，从服务器管理器中删除某台群集服务器时，系统将提示你删除群集中的其他服务器。

-   服务器管理器不显示群集虚拟服务器的数据，因为该数据是动态的，并且与托管虚拟群集节点的服务器的数据完全相同。 你可以选择托管虚拟服务器的服务器以查看其数据。

-   如果使用服务器的虚拟群集对象名称将服务器添加到服务器管理器，服务器管理器中将显示虚拟对象名称，而不是预期的物理服务器名称。

-   不能在群集虚拟服务器上安装角色和功能。

## <a name="see-also"></a>另请参阅
[服务器管理器](server-manager.md) 
[创建和管理服务器组](create-and-manage-server-groups.md)